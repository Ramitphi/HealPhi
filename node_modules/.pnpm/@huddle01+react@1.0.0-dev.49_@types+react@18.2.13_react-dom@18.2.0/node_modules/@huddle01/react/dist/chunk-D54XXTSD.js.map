{"version":3,"sources":["../src/hooks/useRoomMetadata.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport useHuddle01 from './useHuddle01';\nimport { RoomEvents } from '@huddle01/web-core/types';\n\nexport const useRoomMetadata = <T = unknown>(props?: {\n  onMetadataUpdated?: (metadata: T) => void;\n\n  onLeave?: (data: RoomEvents['room-closed'][0]) => void;\n}) => {\n  const { huddleClient } = useHuddle01();\n\n  const room = huddleClient.room;\n\n  const [roomData, setRoomData] = useState<T | null>(\n    room.getMetadata<T>() ?? null,\n  );\n\n  const handleUpdateMetadata = useCallback(() => {\n    const metadata = room.getMetadata<T>();\n\n    setRoomData(metadata);\n\n    if (props?.onMetadataUpdated) props.onMetadataUpdated(metadata);\n  }, [props?.onMetadataUpdated]);\n\n  useEffect(() => {\n    const handleRoomClose = (data: RoomEvents['room-closed'][0]) => {\n      setRoomData(null);\n\n      if (props?.onLeave) props.onLeave(data);\n    };\n\n    const handleRoomJoin = () => {\n      console.info('EVENT TRIGGERED, ROOM JOINED');\n    };\n\n    room.once('room-joined', handleRoomJoin);\n\n    room.once('room-closed', handleRoomClose);\n\n    room.on('metadata-updated', handleUpdateMetadata);\n\n    return () => {\n      room.off('room-joined', handleRoomJoin);\n\n      room.off('room-closed', handleRoomClose);\n\n      room.off('metadata-updated', handleUpdateMetadata);\n    };\n  }, [handleUpdateMetadata]);\n\n  const updateMetadata = room.updateMetadata<T>;\n\n  return {\n    roomData,\n    updateMetadata,\n  };\n};\n"],"mappings":";;;;;AAAA,SAAS,UAAU,WAAW,mBAAmB;AAI1C,IAAM,kBAAkB,CAAc,UAIvC;AACJ,QAAM,EAAE,aAAa,IAAI,oBAAY;AAErC,QAAM,OAAO,aAAa;AAE1B,QAAM,CAAC,UAAU,WAAW,IAAI;AAAA,IAC9B,KAAK,YAAe,KAAK;AAAA,EAC3B;AAEA,QAAM,uBAAuB,YAAY,MAAM;AAC7C,UAAM,WAAW,KAAK,YAAe;AAErC,gBAAY,QAAQ;AAEpB,QAAI,OAAO;AAAmB,YAAM,kBAAkB,QAAQ;AAAA,EAChE,GAAG,CAAC,OAAO,iBAAiB,CAAC;AAE7B,YAAU,MAAM;AACd,UAAM,kBAAkB,CAAC,SAAuC;AAC9D,kBAAY,IAAI;AAEhB,UAAI,OAAO;AAAS,cAAM,QAAQ,IAAI;AAAA,IACxC;AAEA,UAAM,iBAAiB,MAAM;AAC3B,cAAQ,KAAK,8BAA8B;AAAA,IAC7C;AAEA,SAAK,KAAK,eAAe,cAAc;AAEvC,SAAK,KAAK,eAAe,eAAe;AAExC,SAAK,GAAG,oBAAoB,oBAAoB;AAEhD,WAAO,MAAM;AACX,WAAK,IAAI,eAAe,cAAc;AAEtC,WAAK,IAAI,eAAe,eAAe;AAEvC,WAAK,IAAI,oBAAoB,oBAAoB;AAAA,IACnD;AAAA,EACF,GAAG,CAAC,oBAAoB,CAAC;AAEzB,QAAM,iBAAiB,KAAK;AAE5B,SAAO;AAAA,IACL;AAAA,IACA;AAAA,EACF;AACF;","names":[]}